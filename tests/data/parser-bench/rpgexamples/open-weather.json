{"name":"open-weather","code":"**FREE\n//**************************************************************************************************************\n// Basic example of calling a JSON webservice using embedded SQL.\n//  The example API is from OpenWeather and can be found here https://openweathermap.org/current#severalid\n//**************************************************************************************************************\nctl-opt copyright('')\n  datfmt(*ISO) datedit(*YMD/) timfmt(*ISO)\n  debug(*YES) option(*NODEBUGIO: *SRCSTMT)\n  main(main);\n\ndcl-c SQL_NOT_EOF *OFF;\ndcl-c SQL_EOF     *ON;\n\ndcl-c HOST     'https://samples.openweathermap.org';\ndcl-c ENDPOINT '/data/2.5/group?id=&CITY_IDS&units=metric&appid=&APPID';\n\n// Reference fields for use where using SQLTYPE is not legal.\ndcl-ds ref_t template qualified inz;\n  xmlLocator SQLTYPE(XML_LOCATOR);\nend-ds;\n\n// Extracted weather data.\ndcl-ds json_data_t qualified template inz;\n  city varchar(128);\n  temp packed(5: 2);\n  id int(10);\n  main varchar(128);\n  desc varchar(1024);\nend-ds;\n\n//**************************************************************************************************************\n// Entry point\n//**************************************************************************************************************\ndcl-proc main;\n  dcl-pi *N;\n  end-pi;\n\n  dcl-ds json_data likeds(json_data_t);\n  dcl-s message varchar(1000);\n\n  // The sample OpenWeather API always returns the same response regardless of the input.\n  // I.e Moscow, Kiev and London.\n  OpenWeatherApi('524901,703448,2643743');\n\n  dow ReadWeatherApi(json_data);\n\n    // Do something with the data...\n    // json_data.city\n    // json_data.main\n\n    message = 'The weather in ' + json_data.city + ' is ' +\n              %char(json_data.temp) + ' degrees centigrade and ' + json_data.main + '!';\n\n  enddo;\n\n  CloseWeatherApi();\n\nend-proc;\n//**************************************************************************************************************\n// Call the OpenWeather API and open the JSON response for reading.\n//**************************************************************************************************************\ndcl-proc OpenWeatherApi;\n  dcl-pi *N;\n    cities varchar(100) options(*varsize) const;  // List of city ids\n  end-pi;\n\n  dcl-c APPID 'b6907d289e10d714a6e88b30761fae22'; // API key, usually provided by the API owner\n  dcl-s response SQLTYPE(CLOB_LOCATOR);\n  dcl-s requestHeaders SQLTYPE(XML_LOCATOR);\n\n  // Create the XML representation of the HTTP request headers.\n  requestHeaders = CreateHttpRequestHeaders();\n\n  // Execute the webservice call.\n  exec sql\n    set :response = systools.httpgetclob(\n      concat(:HOST, replace(replace(:ENDPOINT, '&CITY_IDS', :cities), '&APPID', :APPID)),\n      :requestHeaders\n    );\n  CheckSqlState(SQLSTT);\n\n  // Create and open a cursor to parse the JSON response.\n  exec sql\n    declare JSON_CURSOR cursor for\n\n    select coalesce(CITY, ''),\n           coalesce(TEMP, 0),\n           coalesce(WEATHER_ID, 0),\n           coalesce(MAIN, ''),\n           coalesce(DESC, '')\n\n    from json_table(\n      :response,\n      'lax $.list[*]'   -- Occurs once per city\n      columns(\n        CITY varchar(50) path '$.name',\n        TEMP dec(5, 2) path '$.main.temp',\n        nested path 'lax $.weather[*]' -- Occurs 1 or more times for each city\n        columns(\n          WEATHER_ID integer path '$.id',\n          MAIN varchar(50) path '$.main',\n          DESC varchar(50) path '$.description'\n        )\n      )\n    ) as X;\n\n  exec sql open JSON_CURSOR;\n  CheckSqlState(SQLSTT);\n\nend-proc;\n//**********************************************************************************\n// Read a JSON array element from the SQL cursor.\n//**********************************************************************************\ndcl-proc ReadWeatherApi;\n  dcl-pi *N like(*IN);\n    json_data likeds(json_data_t);\n  end-pi;\n\n  exec sql fetch JSON_CURSOR into :json_data;\n\n  return CheckSqlState(SQLSTT) <> SQL_EOF;\n\nend-proc;\n//**********************************************************************************\n// Close the cursor\n//**********************************************************************************\ndcl-proc CloseWeatherApi;\n\n  exec sql close JSON_CURSOR;\n  CheckSqlState(SQLSTT);\n\nend-proc;\n//**********************************************************************************\n// Check SQL state (DUMMY!)\n//  This would be replaced by a proper SQL exception testing procedure\n//**********************************************************************************\ndcl-proc CheckSqlState;\n  dcl-pi *N like(*IN);\n    sqlState like(SQLSTT) const;\n  end-pi;\n\n  dcl-s x int(5);\n\n  select;\n    when sqlState = '02000';\n      return SQL_EOF;\n\n    when sqlState = '00000';\n      return SQL_NOT_EOF;\n\n    other;\n      dsply 'Error!';\n      // Force a stupid error in lieu of sending an proper exception...\n      x = x / x;\n      return SQL_EOF;\n\n  endsl;\n\nend-proc;\n//**************************************************************************************************************\n// Create HTTP request headers.\n//  Returns an <httpHeader>...</httpHeader> element as required by the SQL webservice APIs\n//  We must accept a JSON response, so set \"Accept\" header accordingly.\n//**************************************************************************************************************\ndcl-proc CreateHttpRequestHeaders;\n  dcl-pi *N like(ref_t.xmlLocator);\n  end-pi;\n\n  dcl-s headers like(ref_t.xmlLocator);\n\n  exec sql\n    set :headers = xmlelement(\n      name \"httpHeader\",\n      xmlattributes(10000 as \"connectTimeout\", 'true' as \"followRedirects\"),\n      xmlelement(\n        name \"header\",\n        xmlattributes('application/json' as \"Accept\")\n      )\n    );\n\n  return headers;\n\nend-proc;\n//**************************************************************************************************************\n","ast":{"eClass":"https://strumenta.com/kolasu/v1#//Result","root":{"eClass":"#/0/CompilationUnit","position":{"start":{"line":1},"end":{"line":185}},"controlStatements":[{"position":{"start":{"line":6},"end":{"line":9,"column":13}},"controlSpecifications":[{"eClass":"#/0/CopyrightSpecification","position":{"start":{"line":6,"column":8},"end":{"line":6,"column":21}},"expression":{"eClass":"#/0/StringLiteral","position":{"start":{"line":6,"column":18},"end":{"line":6,"column":20}},"value":""}},{"eClass":"#/0/DateFormatSpecification","position":{"start":{"line":7,"column":2},"end":{"line":7,"column":14}},"options":[{"eClass":"#/0/FigurativeConst","position":{"start":{"line":7,"column":9},"end":{"line":7,"column":13}},"text":"*ISO"}]},{"eClass":"#/0/DateditSpecification","position":{"start":{"line":7,"column":15},"end":{"line":7,"column":29}},"options":[{"eClass":"#/0/FigurativeConst","position":{"start":{"line":7,"column":23},"end":{"line":7,"column":28}},"text":"*YMD/"}]},{"eClass":"#/0/TimeFormatSpecification","position":{"start":{"line":7,"column":30},"end":{"line":7,"column":42}},"options":[{"eClass":"#/0/FigurativeConst","position":{"start":{"line":7,"column":37},"end":{"line":7,"column":41}},"text":"*ISO"}]},{"eClass":"#/0/DebugSpecification","position":{"start":{"line":8,"column":2},"end":{"line":8,"column":13}},"configuration":[{"eClass":"#/0/FigurativeConst","position":{"start":{"line":8,"column":8},"end":{"line":8,"column":12}},"text":"*YES"}]},{"eClass":"#/0/OptionSpecification","position":{"start":{"line":8,"column":14},"end":{"line":8,"column":42}},"options":[{"eClass":"#/0/FigurativeConst","position":{"start":{"line":8,"column":21},"end":{"line":8,"column":31}},"text":"*NODEBUGIO"},{"eClass":"#/0/FigurativeConst","position":{"start":{"line":8,"column":33},"end":{"line":8,"column":41}},"text":"*SRCSTMT"}]},{"eClass":"#/0/GenericControlSpecification","position":{"start":{"line":9,"column":2},"end":{"line":9,"column":12}},"name":"MAIN","options":[{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":9,"column":7},"end":{"line":9,"column":11}},"name":"main"}]}]}],"dataDefinitions":[{"eClass":"#/1/Constant","position":{"start":{"line":11},"end":{"line":11,"column":23}},"keywords":[{"eClass":"#/0/ConstKeyword","position":{"start":{"line":11,"column":18},"end":{"line":11,"column":22}},"value":{"eClass":"#/0/FigurativeConst","position":{"start":{"line":11,"column":18},"end":{"line":11,"column":22}},"text":"*OFF"}}],"name":"SQL_NOT_EOF"},{"eClass":"#/1/Constant","position":{"start":{"line":12},"end":{"line":12,"column":22}},"keywords":[{"eClass":"#/0/ConstKeyword","position":{"start":{"line":12,"column":18},"end":{"line":12,"column":21}},"value":{"eClass":"#/0/FigurativeConst","position":{"start":{"line":12,"column":18},"end":{"line":12,"column":21}},"text":"*ON"}}],"name":"SQL_EOF"},{"eClass":"#/1/Constant","position":{"start":{"line":14},"end":{"line":14,"column":52}},"keywords":[{"eClass":"#/0/ConstKeyword","position":{"start":{"line":14,"column":15},"end":{"line":14,"column":51}},"value":{"eClass":"#/0/StringLiteral","position":{"start":{"line":14,"column":15},"end":{"line":14,"column":51}},"value":"https://samples.openweathermap.org"}}],"name":"HOST"},{"eClass":"#/1/Constant","position":{"start":{"line":15},"end":{"line":15,"column":72}},"keywords":[{"eClass":"#/0/ConstKeyword","position":{"start":{"line":15,"column":15},"end":{"line":15,"column":71}},"value":{"eClass":"#/0/StringLiteral","position":{"start":{"line":15,"column":15},"end":{"line":15,"column":71}},"value":"/data/2.5/group?id=&CITY_IDS&units=metric&appid=&APPID"}}],"name":"ENDPOINT"},{"eClass":"#/1/DataStructure","position":{"start":{"line":18},"end":{"line":20,"column":7}},"keywords":[{"eClass":"#/0/TemplateKeyword","position":{"start":{"line":18,"column":13},"end":{"line":18,"column":21}}},{"eClass":"#/0/QualifiedKeyword","position":{"start":{"line":18,"column":22},"end":{"line":18,"column":31}}},{"eClass":"#/0/InitializationKeyword","position":{"start":{"line":18,"column":32},"end":{"line":18,"column":35}}}],"name":"ref_t","subfields":[{"eClass":"#/1/Subfield","name":"xmlLocator"}]},{"eClass":"#/1/DataStructure","position":{"start":{"line":23},"end":{"line":29,"column":7}},"keywords":[{"eClass":"#/0/QualifiedKeyword","position":{"start":{"line":23,"column":19},"end":{"line":23,"column":28}}},{"eClass":"#/0/TemplateKeyword","position":{"start":{"line":23,"column":29},"end":{"line":23,"column":37}}},{"eClass":"#/0/InitializationKeyword","position":{"start":{"line":23,"column":38},"end":{"line":23,"column":41}}}],"name":"json_data_t","subfields":[{"eClass":"#/1/Subfield","name":"city"},{"eClass":"#/1/Subfield","name":"temp"},{"eClass":"#/1/Subfield","name":"id"},{"eClass":"#/1/Subfield","name":"main"},{"eClass":"#/1/Subfield","name":"desc"}]}],"procedures":[{"position":{"start":{"line":34},"end":{"line":58,"column":9}},"name":"main","body":[{"eClass":"#/0/ExpressionStatement","position":{"start":{"line":43,"column":2},"end":{"line":43,"column":42}},"expression":{"eClass":"#/0/ArrayAccessExpr","position":{"start":{"line":43,"column":2},"end":{"line":43,"column":41}},"array":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":43,"column":2},"end":{"line":43,"column":16}},"name":"OpenWeatherApi"},"index":{"eClass":"#/0/StringLiteral","position":{"start":{"line":43,"column":17},"end":{"line":43,"column":40}},"value":"524901,703448,2643743"}}},{"eClass":"#/0/DoWhileStatement","position":{"start":{"line":45,"column":2},"end":{"line":54,"column":8}},"body":[{"eClass":"#/0/ExpressionStatement","position":{"start":{"line":51,"column":4},"end":{"line":52,"column":88}},"expression":{"eClass":"#/0/ComparisonExpr","position":{"start":{"line":51,"column":4},"end":{"line":52,"column":87}},"left":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":51,"column":4},"end":{"line":51,"column":11}},"name":"message"},"right":{"eClass":"#/0/SumExpr","position":{"start":{"line":51,"column":14},"end":{"line":52,"column":87}},"left":{"eClass":"#/0/FieldAccessExpr","position":{"start":{"line":51,"column":14},"end":{"line":52,"column":81}},"container":{"eClass":"#/0/SumExpr","position":{"start":{"line":51,"column":14},"end":{"line":52,"column":76}},"left":{"eClass":"#/0/SumExpr","position":{"start":{"line":51,"column":14},"end":{"line":52,"column":64}},"left":{"eClass":"#/0/SumExpr","position":{"start":{"line":51,"column":14},"end":{"line":52,"column":35}},"left":{"eClass":"#/0/SumExpr","position":{"start":{"line":51,"column":14},"end":{"line":51,"column":57}},"left":{"eClass":"#/0/FieldAccessExpr","position":{"start":{"line":51,"column":14},"end":{"line":51,"column":48}},"container":{"eClass":"#/0/SumExpr","position":{"start":{"line":51,"column":14},"end":{"line":51,"column":43}},"left":{"eClass":"#/0/StringLiteral","position":{"start":{"line":51,"column":14},"end":{"line":51,"column":31}},"value":"The weather in "},"right":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":51,"column":34},"end":{"line":51,"column":43}},"name":"json_data"}},"fieldName":"city"},"right":{"eClass":"#/0/StringLiteral","position":{"start":{"line":51,"column":51},"end":{"line":51,"column":57}},"value":" is "}},"right":{"eClass":"#/0/BuiltinFunctionCall","position":{"start":{"line":52,"column":14},"end":{"line":52,"column":35}},"functionName":"%char","params":[{"eClass":"#/0/FieldAccessExpr","position":{"start":{"line":52,"column":20},"end":{"line":52,"column":34}},"container":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":52,"column":20},"end":{"line":52,"column":29}},"name":"json_data"},"fieldName":"temp"}]}},"right":{"eClass":"#/0/StringLiteral","position":{"start":{"line":52,"column":38},"end":{"line":52,"column":64}},"value":" degrees centigrade and "}},"right":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":52,"column":67},"end":{"line":52,"column":76}},"name":"json_data"}},"fieldName":"main"},"right":{"eClass":"#/0/StringLiteral","position":{"start":{"line":52,"column":84},"end":{"line":52,"column":87}},"value":"!"}}}}],"condition":{"eClass":"#/0/ArrayAccessExpr","position":{"start":{"line":45,"column":6},"end":{"line":45,"column":31}},"array":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":45,"column":6},"end":{"line":45,"column":20}},"name":"ReadWeatherApi"},"index":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":45,"column":21},"end":{"line":45,"column":30}},"name":"json_data"}}},{"eClass":"#/0/ExpressionStatement","position":{"start":{"line":56,"column":2},"end":{"line":56,"column":20}},"expression":{"eClass":"#/0/UserDefinedFunctionCall","position":{"start":{"line":56,"column":2},"end":{"line":56,"column":19}},"functionName":"CloseWeatherApi"}}],"dataDefinitions":[{"eClass":"#/1/DataStructure","position":{"start":{"line":38,"column":2},"end":{"line":38,"column":39}},"keywords":[{"eClass":"#/0/LikeDSKeyword","position":{"start":{"line":38,"column":19},"end":{"line":38,"column":38}},"dataStructureName":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":38,"column":26},"end":{"line":38,"column":37}},"name":"json_data_t"}}],"name":"json_data"},{"eClass":"#/1/StandaloneField","position":{"start":{"line":39,"column":2},"end":{"line":39,"column":30}},"keywords":[{"eClass":"#/0/VarCharTypeKeyword","position":{"start":{"line":39,"column":16},"end":{"line":39,"column":29}},"length":{"eClass":"#/0/IntLiteral","position":{"start":{"line":39,"column":24},"end":{"line":39,"column":28}},"value":"1000"}}],"name":"message"}],"interfaces":[{"eClass":"#/1/ProcedureInterface","position":{"start":{"line":35,"column":2},"end":{"line":36,"column":9}},"name":"*N"}]},{"position":{"start":{"line":62},"end":{"line":110,"column":9}},"name":"OpenWeatherApi","body":[{"eClass":"#/0/ExpressionStatement","position":{"start":{"line":72,"column":2},"end":{"line":72,"column":46}},"expression":{"eClass":"#/0/ComparisonExpr","position":{"start":{"line":72,"column":2},"end":{"line":72,"column":45}},"left":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":72,"column":2},"end":{"line":72,"column":16}},"name":"requestHeaders"},"right":{"eClass":"#/0/UserDefinedFunctionCall","position":{"start":{"line":72,"column":19},"end":{"line":72,"column":45}},"functionName":"CreateHttpRequestHeaders"}}},{"eClass":"#/0/ExecSqlStatement","position":{"start":{"line":75,"column":2},"end":{"line":79,"column":6}},"sqlCode":"\n    set :response = systools.httpgetclob(\n      concat(:HOST, replace(replace(:ENDPOINT, '&CITY_IDS', :cities), '&APPID', :APPID)),\n      :requestHeaders\n    )"},{"eClass":"#/0/ExpressionStatement","position":{"start":{"line":80,"column":2},"end":{"line":80,"column":24}},"expression":{"eClass":"#/0/ArrayAccessExpr","position":{"start":{"line":80,"column":2},"end":{"line":80,"column":23}},"array":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":80,"column":2},"end":{"line":80,"column":15}},"name":"CheckSqlState"},"index":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":80,"column":16},"end":{"line":80,"column":22}},"name":"SQLSTT"}}},{"eClass":"#/0/ExecSqlStatement","position":{"start":{"line":83,"column":2},"end":{"line":105,"column":11}},"sqlCode":"\n    declare JSON_CURSOR cursor for\n\n    select coalesce(CITY, ''),\n           coalesce(TEMP, 0),\n           coalesce(WEATHER_ID, 0),\n           coalesce(MAIN, ''),\n           coalesce(DESC, '')\n\n    from json_table(\n      :response,\n      'lax $.list[*]'   -- Occurs once per city\n      columns(\n        CITY varchar(50) path '$.name',\n        TEMP dec(5, 2) path '$.main.temp',\n        nested path 'lax $.weather[*]' -- Occurs 1 or more times for each city\n        columns(\n          WEATHER_ID integer path '$.id',\n          MAIN varchar(50) path '$.main',\n          DESC varchar(50) path '$.description'\n        )\n      )\n    ) as X"},{"eClass":"#/0/ExecSqlStatement","position":{"start":{"line":107,"column":2},"end":{"line":107,"column":28}},"sqlCode":" open JSON_CURSOR"},{"eClass":"#/0/ExpressionStatement","position":{"start":{"line":108,"column":2},"end":{"line":108,"column":24}},"expression":{"eClass":"#/0/ArrayAccessExpr","position":{"start":{"line":108,"column":2},"end":{"line":108,"column":23}},"array":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":108,"column":2},"end":{"line":108,"column":15}},"name":"CheckSqlState"},"index":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":108,"column":16},"end":{"line":108,"column":22}},"name":"SQLSTT"}}}],"dataDefinitions":[{"eClass":"#/1/Constant","position":{"start":{"line":67,"column":2},"end":{"line":67,"column":49}},"keywords":[{"eClass":"#/0/ConstKeyword","position":{"start":{"line":67,"column":14},"end":{"line":67,"column":48}},"value":{"eClass":"#/0/StringLiteral","position":{"start":{"line":67,"column":14},"end":{"line":67,"column":48}},"value":"b6907d289e10d714a6e88b30761fae22"}}],"name":"APPID"},{"eClass":"#/1/StandaloneField","position":{"start":{"line":68,"column":2},"end":{"line":68,"column":39}},"keywords":[{"eClass":"#/0/ConstKeyword","position":{"start":{"line":68,"column":17},"end":{"line":68,"column":38}},"value":{"eClass":"#/0/ArrayAccessExpr","position":{"start":{"line":68,"column":17},"end":{"line":68,"column":38}},"array":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":68,"column":17},"end":{"line":68,"column":24}},"name":"SQLTYPE"},"index":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":68,"column":25},"end":{"line":68,"column":37}},"name":"CLOB_LOCATOR"}}}],"name":"response"},{"eClass":"#/1/StandaloneField","position":{"start":{"line":69,"column":2},"end":{"line":69,"column":44}},"keywords":[{"eClass":"#/0/ConstKeyword","position":{"start":{"line":69,"column":23},"end":{"line":69,"column":43}},"value":{"eClass":"#/0/ArrayAccessExpr","position":{"start":{"line":69,"column":23},"end":{"line":69,"column":43}},"array":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":69,"column":23},"end":{"line":69,"column":30}},"name":"SQLTYPE"},"index":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":69,"column":31},"end":{"line":69,"column":42}},"name":"XML_LOCATOR"}}}],"name":"requestHeaders"}],"interfaces":[{"eClass":"#/1/ProcedureInterface","position":{"start":{"line":63,"column":2},"end":{"line":65,"column":9}},"name":"*N","parameters":[{"position":{"start":{"line":64,"column":4},"end":{"line":64,"column":48}},"keywords":[{"eClass":"#/0/VarCharTypeKeyword","position":{"start":{"line":64,"column":11},"end":{"line":64,"column":23}},"length":{"eClass":"#/0/IntLiteral","position":{"start":{"line":64,"column":19},"end":{"line":64,"column":22}},"value":"100"}},{"eClass":"#/0/OptionsKeyword","position":{"start":{"line":64,"column":24},"end":{"line":64,"column":41}},"options":[{"eClass":"#/0/FigurativeConst","position":{"start":{"line":64,"column":32},"end":{"line":64,"column":40}},"text":"*varsize"}]},{"eClass":"#/0/ConstKeyword","position":{"start":{"line":64,"column":42},"end":{"line":64,"column":47}}}],"name":"cities"}]}]},{"position":{"start":{"line":114},"end":{"line":123,"column":9}},"name":"ReadWeatherApi","body":[{"eClass":"#/0/ExecSqlStatement","position":{"start":{"line":119,"column":2},"end":{"line":119,"column":45}},"sqlCode":" fetch JSON_CURSOR into :json_data"},{"eClass":"#/0/ReturnStatement","position":{"start":{"line":121,"column":2},"end":{"line":121,"column":42}},"value":{"eClass":"#/0/ComparisonExpr","position":{"start":{"line":121,"column":9},"end":{"line":121,"column":41}},"comparisonType":"Inequality","left":{"eClass":"#/0/ArrayAccessExpr","position":{"start":{"line":121,"column":9},"end":{"line":121,"column":30}},"array":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":121,"column":9},"end":{"line":121,"column":22}},"name":"CheckSqlState"},"index":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":121,"column":23},"end":{"line":121,"column":29}},"name":"SQLSTT"}},"right":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":121,"column":34},"end":{"line":121,"column":41}},"name":"SQL_EOF"}}}],"interfaces":[{"eClass":"#/1/ProcedureInterface","position":{"start":{"line":115,"column":2},"end":{"line":117,"column":9}},"keywords":[{"eClass":"#/0/LikeKeyword","position":{"start":{"line":115,"column":12},"end":{"line":115,"column":21}},"name":{"eClass":"#/0/FigurativeConst","position":{"start":{"line":115,"column":17},"end":{"line":115,"column":20}},"text":"*IN"}}],"name":"*N","parameters":[{"position":{"start":{"line":116,"column":4},"end":{"line":116,"column":34}},"keywords":[{"eClass":"#/0/LikeDSKeyword","position":{"start":{"line":116,"column":14},"end":{"line":116,"column":33}},"dataStructureName":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":116,"column":21},"end":{"line":116,"column":32}},"name":"json_data_t"}}],"name":"json_data"}]}]},{"position":{"start":{"line":127},"end":{"line":132,"column":9}},"name":"CloseWeatherApi","body":[{"eClass":"#/0/ExecSqlStatement","position":{"start":{"line":129,"column":2},"end":{"line":129,"column":29}},"sqlCode":" close JSON_CURSOR"},{"eClass":"#/0/ExpressionStatement","position":{"start":{"line":130,"column":2},"end":{"line":130,"column":24}},"expression":{"eClass":"#/0/ArrayAccessExpr","position":{"start":{"line":130,"column":2},"end":{"line":130,"column":23}},"array":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":130,"column":2},"end":{"line":130,"column":15}},"name":"CheckSqlState"},"index":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":130,"column":16},"end":{"line":130,"column":22}},"name":"SQLSTT"}}}]},{"position":{"start":{"line":137},"end":{"line":159,"column":9}},"name":"CheckSqlState","body":[{"eClass":"#/0/SelectStatement","position":{"start":{"line":144,"column":2},"end":{"line":157,"column":8}},"otherClause":{"position":{"start":{"line":151,"column":4},"end":{"line":155,"column":21}},"body":[{"eClass":"#/0/DisplayStatement","position":{"start":{"line":152,"column":6},"end":{"line":152,"column":21}},"message":{"eClass":"#/0/StringLiteral","position":{"start":{"line":152,"column":12},"end":{"line":152,"column":20}},"value":"Error!"}},{"eClass":"#/0/ExpressionStatement","position":{"start":{"line":154,"column":6},"end":{"line":154,"column":16}},"expression":{"eClass":"#/0/ComparisonExpr","position":{"start":{"line":154,"column":6},"end":{"line":154,"column":15}},"left":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":154,"column":6},"end":{"line":154,"column":7}},"name":"x"},"right":{"eClass":"#/0/DivideExpr","position":{"start":{"line":154,"column":10},"end":{"line":154,"column":15}},"left":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":154,"column":10},"end":{"line":154,"column":11}},"name":"x"},"right":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":154,"column":14},"end":{"line":154,"column":15}},"name":"x"}}}},{"eClass":"#/0/ReturnStatement","position":{"start":{"line":155,"column":6},"end":{"line":155,"column":21}},"value":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":155,"column":13},"end":{"line":155,"column":20}},"name":"SQL_EOF"}}]},"whenClauses":[{"eClass":"#/0/ConditionWhenClause","position":{"start":{"line":145,"column":4},"end":{"line":146,"column":21}},"body":[{"eClass":"#/0/ReturnStatement","position":{"start":{"line":146,"column":6},"end":{"line":146,"column":21}},"value":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":146,"column":13},"end":{"line":146,"column":20}},"name":"SQL_EOF"}}],"condition":{"eClass":"#/0/ComparisonExpr","position":{"start":{"line":145,"column":9},"end":{"line":145,"column":27}},"left":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":145,"column":9},"end":{"line":145,"column":17}},"name":"sqlState"},"right":{"eClass":"#/0/StringLiteral","position":{"start":{"line":145,"column":20},"end":{"line":145,"column":27}},"value":"02000"}}},{"eClass":"#/0/ConditionWhenClause","position":{"start":{"line":148,"column":4},"end":{"line":149,"column":25}},"body":[{"eClass":"#/0/ReturnStatement","position":{"start":{"line":149,"column":6},"end":{"line":149,"column":25}},"value":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":149,"column":13},"end":{"line":149,"column":24}},"name":"SQL_NOT_EOF"}}],"condition":{"eClass":"#/0/ComparisonExpr","position":{"start":{"line":148,"column":9},"end":{"line":148,"column":27}},"left":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":148,"column":9},"end":{"line":148,"column":17}},"name":"sqlState"},"right":{"eClass":"#/0/StringLiteral","position":{"start":{"line":148,"column":20},"end":{"line":148,"column":27}},"value":"00000"}}}]}],"dataDefinitions":[{"eClass":"#/1/StandaloneField","position":{"start":{"line":142,"column":2},"end":{"line":142,"column":17}},"keywords":[{"eClass":"#/0/IntegerTypeKeyword","position":{"start":{"line":142,"column":10},"end":{"line":142,"column":16}},"value":{"eClass":"#/0/IntLiteral","position":{"start":{"line":142,"column":14},"end":{"line":142,"column":15}},"value":"5"}}],"name":"x"}],"interfaces":[{"eClass":"#/1/ProcedureInterface","position":{"start":{"line":138,"column":2},"end":{"line":140,"column":9}},"keywords":[{"eClass":"#/0/LikeKeyword","position":{"start":{"line":138,"column":12},"end":{"line":138,"column":21}},"name":{"eClass":"#/0/FigurativeConst","position":{"start":{"line":138,"column":17},"end":{"line":138,"column":20}},"text":"*IN"}}],"name":"*N","parameters":[{"position":{"start":{"line":139,"column":4},"end":{"line":139,"column":32}},"keywords":[{"eClass":"#/0/LikeKeyword","position":{"start":{"line":139,"column":13},"end":{"line":139,"column":25}},"name":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":139,"column":18},"end":{"line":139,"column":24}},"name":"SQLSTT"}},{"eClass":"#/0/ConstKeyword","position":{"start":{"line":139,"column":26},"end":{"line":139,"column":31}}}],"name":"sqlState"}]}]},{"position":{"start":{"line":165},"end":{"line":183,"column":9}},"name":"CreateHttpRequestHeaders","body":[{"eClass":"#/0/ExecSqlStatement","position":{"start":{"line":171,"column":2},"end":{"line":179,"column":6}},"sqlCode":"\n    set :headers = xmlelement(\n      name \"httpHeader\",\n      xmlattributes(10000 as \"connectTimeout\", 'true' as \"followRedirects\"),\n      xmlelement(\n        name \"header\",\n        xmlattributes('application/json' as \"Accept\")\n      )\n    )"},{"eClass":"#/0/ReturnStatement","position":{"start":{"line":181,"column":2},"end":{"line":181,"column":17}},"value":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":181,"column":9},"end":{"line":181,"column":16}},"name":"headers"}}],"dataDefinitions":[{"eClass":"#/1/StandaloneField","position":{"start":{"line":169,"column":2},"end":{"line":169,"column":39}},"keywords":[{"eClass":"#/0/LikeKeyword","position":{"start":{"line":169,"column":16},"end":{"line":169,"column":38}},"name":{"eClass":"#/0/FieldAccessExpr","position":{"start":{"line":169,"column":21},"end":{"line":169,"column":37}},"container":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":169,"column":21},"end":{"line":169,"column":26}},"name":"ref_t"},"fieldName":"xmlLocator"}}],"name":"headers"}],"interfaces":[{"eClass":"#/1/ProcedureInterface","position":{"start":{"line":166,"column":2},"end":{"line":167,"column":9}},"keywords":[{"eClass":"#/0/LikeKeyword","position":{"start":{"line":166,"column":12},"end":{"line":166,"column":34}},"name":{"eClass":"#/0/FieldAccessExpr","position":{"start":{"line":166,"column":17},"end":{"line":166,"column":33}},"container":{"eClass":"#/0/ReferenceExpr","position":{"start":{"line":166,"column":17},"end":{"line":166,"column":22}},"name":"ref_t"},"fieldName":"xmlLocator"}}],"name":"*N"}]}]}},"astBuildingTime":null}